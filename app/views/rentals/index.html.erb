<h1>レンタル管理画面</h1>

<% if flash[:success] %>
  <div style="background-color: #d4edda; color: #155724; padding: 10px; border: 1px solid #c3e6cb; border-radius: 4px; margin-bottom: 15px;">
    ✅ <%= flash[:success] %>
  </div>
<% end %>

<% if flash[:error] %>
  <div style="background-color: #f8d7da; color: #721c24; padding: 10px; border: 1px solid #f5c6cb; border-radius: 4px; margin-bottom: 15px;">
    ❌ <%= flash[:error] %>
  </div>
<% end %>

<table border="1" style="border-collapse: collapse; width: 100%;">
  <thead>
    <tr>
      <th>注文番号</th>
      <th>LINE User ID</th>
      <th>Display Name</th>
      <th>Uniform Info</th>
      <th>Status</th>
      <th>申請日時</th>
      <th>Actions</th>
    </tr>
  </thead>
  <tbody>
    <% @rentals.order(created_at: :desc).each do |rental| %>
      <tr>
        <td><strong><%= rental.id %></strong></td>
        <td><%= rental.line_user_id || "-" %></td>
        <td><%= rental.display_name || "-" %></td>
        <td><%= rental.uniform_info || rental.uniform_type %></td>
        <td>
          <span style="color: <%= rental.status == 'requested' ? 'orange' : rental.status == 'rented' ? 'blue' : 'green' %>;">
            <%= rental.status || "未設定" %>
          </span>
        </td>
        <td><%= rental.requested_at&.strftime("%m/%d %H:%M") || rental.created_at.strftime("%m/%d %H:%M") %></td>
        <td>
          <%= button_to "貸出中にする", rental_path(rental), method: :patch, params: { status: "rented" }, style: "margin: 2px;" %>
          <%= button_to "返却済にする", rental_path(rental), method: :patch, params: { status: "returned" }, style: "margin: 2px;" %>
        </td>
      </tr>
    <% end %>
  </tbody>
</table>

<% if @rentals.empty? %>
  <p>レンタルデータがありません。</p>
<% end %>
